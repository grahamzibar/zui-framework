!function(){window.ZUI={}}(),function(){ZUI.Helper={}}(),function(){ZUI.Helper.KeySpline=function(a,b,c,d){function e(a,b){return 1-3*b+3*a}function f(a,b){return 3*b-6*a}function g(a){return 3*a}function h(a,b,c){return((e(b,c)*a+f(b,c))*a+g(b))*a}function i(a,b,c){return 3*e(b,c)*a*a+2*f(b,c)*a+g(b)}function j(b){for(var d=b,e=0;4>e;++e){var f=i(d,a,c);if(0==f)return d;var g=h(d,a,c)-b;d-=g/f}return d}this.get=function(e){return a==b&&c==d?e:h(j(e),b,d)}}}(),function(){ZUI.Helper.removeFromArray=function(a,b){var c=a.indexOf(b);return c>=0&&a.splice(c,1),b},ZUI.Helper.inheritClass=function(a,b){function c(){this.constructor=b.prototype.constructor}c.prototype=a.prototype,b.prototype=new c},ZUI.Helper.assignDefaultProperty=function(a,b,c){var d=!1;if("string"!=typeof c&&!(c instanceof Array))for(var e in c){d=!0;break}if(void 0===b[a]&&(b[a]=d?{}:c),"string"!=typeof c&&!(c instanceof Array))for(var e in c)ZUI.Helper.assignDefaultProperty(e,b[a],c[e]);return b[a]},ZUI.Helper.interpretScale=function(a,b){return b===ZUI.Def.ScreenScale?a:b===ZUI.Def.WorldScale?isNaN(Number(a))?ZUI.camera.projectPoint(a):ZUI.camera.projectDistance(a):null},ZUI.Helper.interpretCenterAt=function(a,b,c,d){var e={x:a.x+b.x,y:a.y+b.y};if(this.centerAt.horizontal===ZUI.Def.Left)e.x-=0;else if(this.centerAt.horizontal===ZUI.Def.Center)e.x-=c/2;else{if(this.centerAt.horizontal!==ZUI.Def.Right)throw{name:"InvalidPropertyException",message:"Value of centerAt is invalid."};e.x-=c}if(this.centerAt.vertical===ZUI.Def.Top)e.y-=0;else if(this.centerAt.vertical===ZUI.Def.Center)e.y-=d/2;else{if(this.centerAt.vertical!==ZUI.Def.Bottom)throw{name:"InvalidPropertyException",message:"Value of centerAt is invalid."};e.y-=d}return e},ZUI.Helper.isValidColor=function(a){return a&&a.match?null!==a.match(/^#[a-f0-9]{6}$/i):null},ZUI.Helper.isEndsWith=function(a,b){return-1!==a.indexOf(b,a.length-b.length)},ZUI.Helper.getNumberWithComma=function(a){var b=(a+"").split(".");return b[0]=b[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),b.join(".")},ZUI.Helper.regexIndexOf=function(a,b,c){var d=a.substring(c||0).search(b);return d>=0?d+(c||0):d},ZUI.Helper.getTime=function(){return(new Date).getTime()},ZUI.Helper.stopBubble=function(a){a.stopPropagation()},ZUI.Helper.getColorString=function(a,b,c){if(void 0!==a.red&&void 0!==a.green&&void 0!==a.blue){var d=a;a=d.red,b=d.green,c=d.blue}var e=a.toString(16);1==e.length&&(e="0"+e);var f=b.toString(16);1==f.length&&(f="0"+f);var g=c.toString(16);return 1==g.length&&(g="0"+g),"#"+e+f+g},ZUI.Helper.getColorComponents=function(a){var b=a.substring(0);"#"==b[0]&&(b=a.substring(1));var c=parseInt(b.substring(0,2),16),d=parseInt(b.substring(2,4),16),e=parseInt(b.substring(4,6),16);return isNaN(c)||isNaN(d)||isNaN(e)?null:{red:c,green:d,blue:e}},ZUI.Helper.readPropertyPath=function(a){for(var b=a.split("."),c=window,d=0;d<b.length;d++)if(c=c[b[d]],void 0===c||null===c)throw{name:"BadPathException",message:"The path "+a+" cannot be found."};return c},ZUI.Helper.parseSVGPath=function(a){for(var b=[],c=0;c+1<a.length;){var d=a[c],e=ZUI.Util.regexIndexOf(a,"[A-Za-z]",c+1);0>e&&(e=a.length);for(var f=a.substring(c+1,e).replace(new RegExp("([0-9])-","gi"),"$1,-").trim().replace(new RegExp("[	\n ,]+","gi"),",").split(/[,]+/),g=0;g<f.length;g++)f[g]=Number(f[g]);b.push({instruction:d,args:f}),c=e}var h=[],i=0,j=0;for(c=0;c<b.length;c++)if("M"==b[c].instruction){var k={};k.instruction="moveTo",k.args=[b[c].args[0],b[c].args[1]],h.push(k),i=b[c].args[0],j=b[c].args[1]}else if("m"==b[c].instruction){var k={};k.instruction="moveTo",k.args=[b[c].args[0]+i,b[c].args[1]+j],h.push(k),i+=b[c].args[0],j+=b[c].args[1]}else if("Z"==b[c].instruction||"z"==b[c].instruction){var k={};k.instruction="closePath",k.args=[],h.push(k)}else if("L"==b[c].instruction){var k={};k.instruction="lineTo",k.args=[b[c].args[0],b[c].args[1]],h.push(k),i=b[c].args[0],j=b[c].args[1]}else if("l"==b[c].instruction){var k={};k.instruction="lineTo",k.args=[b[c].args[0]+i,b[c].args[1]+j],h.push(k),i+=b[c].args[0],j+=b[c].args[1]}else if("H"==b[c].instruction){var k={};k.instruction="lineTo",k.args=[b[c].args[0],j],h.push(k),i=b[c].args[0]}else if("h"==b[c].instruction){var k={};k.instruction="lineTo",k.args=[b[c].args[0]+i,j],h.push(k),i+=b[c].args[0]}else if("V"==b[c].instruction){var k={};k.instruction="lineTo",k.args=[i,b[c].args[0]],h.push(k),j=b[c].args[0]}else if("v"==b[c].instruction){var k={};k.instruction="lineTo",k.args=[i,b[c].args[0]+j],h.push(k),j+=b[c].args[0]}else if("C"==b[c].instruction){var k={};k.instruction="bezierCurveTo",k.args=[b[c].args[0],b[c].args[1],b[c].args[2],b[c].args[3],b[c].args[4],b[c].args[5]],h.push(k),i=b[c].args[4],j=b[c].args[5]}else if("c"==b[c].instruction){var k={};k.instruction="bezierCurveTo",k.args=[b[c].args[0]+i,b[c].args[1]+j,b[c].args[2]+i,b[c].args[3]+j,b[c].args[4]+i,b[c].args[5]+j],h.push(k),i+=b[c].args[4],j+=b[c].args[5]}else if("S"==b[c].instruction){var k={};k.instruction="bezierCurveTo",k.args=[i,j,b[c].args[0],b[c].args[1],b[c].args[2],b[c].args[3]],h.push(k),i=b[c].args[2],j=b[c].args[3]}else if("s"==b[c].instruction){var k={};k.instruction="bezierCurveTo",k.args=[i,j,b[c].args[0]+i,b[c].args[1]+j,b[c].args[2]+i,b[c].args[3]+j],h.push(k),i+=b[c].args[2],j+=b[c].args[3]}else if("Q"==b[c].instruction){var k={};k.instruction="quadraticCurveTo",k.args=[b[c].args[0],b[c].args[1],b[c].args[2],b[c].args[3]],h.push(k),i=b[c].args[2],j=b[c].args[3]}else if("q"==b[c].instruction){var k={};k.instruction="quadraticCurveTo",k.args=[b[c].args[0]+i,b[c].args[1]+j,b[c].args[2]+i,b[c].args[3]+j],h.push(k),i+=b[c].args[2],j+=b[c].args[3]}else if("T"==b[c].instruction){var k={};k.instruction="quadraticCurveTo",k.args=[i,j,b[c].args[0],b[c].args[1]],h.push(k),i=b[c].args[0],j=b[c].args[1]}else if("t"==b[c].instruction){var k={};k.instruction="quadraticCurveTo",k.args=[i,j,b[c].args[0]+i,b[c].args[1]+j],h.push(k),i+=b[c].args[0],j+=b[c].args[1]}else if("A"==b[c].instruction){var k={};k.instruction="arcTo",k.args=[b[c].args[0],b[c].args[1],b[c].args[2],b[c].args[3],b[c].args[4]],h.push(k),i=b[c].args[2],j=b[c].args[3]}else if("a"==b[c].instruction){var k={};k.instruction="arcTo",k.args=[b[c].args[0]+i,b[c].args[1]+j,b[c].args[2]+i,b[c].args[3]+j,b[c].args[4]],h.push(k),i+=b[c].args[2],j+=b[c].args[3]}return h}}(),function(){ZUI.Def={}}(),function(){ZUI.Def.Left=1,ZUI.Def.Right=2,ZUI.Def.Top=3,ZUI.Def.Bottom=4,ZUI.Def.Center=5,ZUI.Def.WorldScale=17,ZUI.Def.ScreenScale=18}(),function(){ZUI.Math={}}(),function(){ZUI.Math.log=function(a,b){return Math.log(a)/Math.log(b)},ZUI.Math.mean=function(a){for(var b=0,c=0;c<a.length;c++)b+=a[c];return b/a.length},ZUI.Math.stDev=function(a){if(a.length<2)return Number.NaN;for(var b=ZUI.Helper.mean(a),c=0,d=0;d<a.length;d++)c+=Math.pow(b-a[d],2);return Math.sqrt(c/(a.length-1))},ZUI.Math.stError=function(a){return a.length<2?Number.NaN:ZUI.Helper.stdev(a)/Math.sqrt(a.length)}}(),function(){ZUI.Hash=function(){ZUI.Base.call(this),this._private.pairs=[]},ZUI.Helper.inheritClass(ZUI.Base,ZUI.Hash),ZUI.Hash.prototype.put=function(a,b){for(var c=0;c<this._private.pairs.length;c++)if(this._private.pairs[c].key==a)return void(this._private.pairs[c].value=b);this._private.pairs.push({key:a,value:b})},ZUI.Hash.prototype.get=function(a){for(var b=0;b<this._private.pairs.length;b++)if(this._private.pairs[b].key==a)return this._private.pairs[b].value;return null},ZUI.Hash.prototype.delete=function(a){for(var b=0;b<this._private.pairs.length;b++)if(this._private.pairs[b].key==a)return void this._private.pairs.splice(b,1)},ZUI.Hash.prototype.getKeys=function(){for(var a=[],b=0;b<this._private.pairs.length;b++)a.push(this._private.pairs[b].key);return a},ZUI.Hash.prototype.getSize=function(){return this._private.pairs.length}}(),function(){ZUI.Event=function(a,b,c){ZUI.Base.call(this),this.type=a,this.target=b,this.data=c,this.timeStamp=ZUI.Helper.getTime()},ZUI.Helper.inheritClass(ZUI.Base,ZUI.Event)}(),function(){ZUI.EventListener=function(a,b,c,d){ZUI.Base.call(this),this.type=a,this.target=b,this.callback=c,this.data=d},ZUI.Helper.inheritClass(ZUI.Base,ZUI.EventListener)}(),function(){ZUI.width=null,ZUI.height=null,ZUI.background=null,ZUI.container=null,ZUI.canvas=null,ZUI.context=null,ZUI.camera=null,ZUI.frameRate=null,ZUI.lastTimeStamp=null,ZUI.activeView=null,ZUI.contextMenu=null,ZUI.appStatus=null,ZUI.mouseStatus=null,ZUI.eventListeners=null,ZUI.passInputEvent=null}(),function(){ZUI.initialize=function(a){for(var b in a)ZUI[b]=a[b];!function(){var a={width:900,height:600,background:"#FFFFFF",backgroundAlpha:0,frameRate:30,cameraFollowRate:1};for(var b in a)ZUI.Helper.assignDefaultProperty(b,ZUI,a[b])}(),a.canvas&&(ZUI.container=a.canvas.parentNode,ZUI.canvas=a.canvas,ZUI.context=ZUI.canvas.getContext("2d")),ZUI.camera=new ZUI.Camera.DefaultCamera({}),ZUI.contextMenu=new ZUI.ContextMenu,ZUI.canvas.width=ZUI.width,ZUI.canvas.height=ZUI.height,ZUI.canvas.style.cursor="default",ZUI.canvas.addEventListener("mousedown",ZUI.mouseDown,!1),document.addEventListener("mouseup",ZUI.mouseUp,!1),ZUI.canvas.addEventListener("mousemove",ZUI.mouseMove,!1),ZUI.canvas.addEventListener("click",ZUI.click,!1),ZUI.canvas.addEventListener("dblclick",ZUI.doubleClick,!1),ZUI.canvas.addEventListener("mousewheel",ZUI.mouseWheel,!1),ZUI.canvas.addEventListener("DOMMouseScroll",ZUI.mouseWheel,!1),ZUI.canvas.oncontextmenu=function(a){return ZUI.contextMenu(a),!1},ZUI.eventListeners=new ZUI.Hash,ZUI.activeView=new ZUI.View,ZUI.activeView.active(),requestAnimationFrame(ZUI.draw)},ZUI.draw=function(a){if(requestAnimationFrame(ZUI.draw),a-ZUI.lastTimeStamp>1e3/ZUI.frameRate){ZUI.lastTimeStamp=a-(a-ZUI.lastTimeStamp)%1e3/ZUI.frameRate,null==ZUI.appStatus.start&&(ZUI.appStatus.start=a),ZUI.appStatus.progress=a-ZUI.appStatus.start,ZUI.camera.update(),ZUI.update();for(var b=!1,c=0;c<ZUI.activeView.renderedObjects.length;c++)ZUI.activeView.renderedObjects[c].isUpdated&&(ZUI.activeView.renderedObjects[c].render(),ZUI.activeView.renderedObjects[c].isUpdated=!1,b=!0);if(b){ZUI.context.clearRect(0,0,ZUI.width,ZUI.height),ZUI.backgroundAlpha>0&&(ZUI.context.save(),ZUI.context.globalAlpha=ZUI.backgroundAlpha,ZUI.context.strokeStyle=ZUI.background,ZUI.context.fillStyle=ZUI.background,ZUI.context.fillRect(0,0,ZUI.width,ZUI.height),ZUI.context.restore());for(var c=0;c<ZUI.activeView.renderedObjects.length;c++)ZUI.activeView.renderedObjects[c].draw()}for(var d=ZUI.mouseStatus.x,e=ZUI.mouseStatus.y,f=ZUI.activeView.renderedObjects,g=null,c=0;c<f.length;c++)f[c].isInBound(d,e)&&(g=f[c]);for(c=0;c<f.length;c++)f[c]!=g&&f[c]._private.isHovered&&(f[c]._private.isHovered=!1,f[c].mouseOut());g&&(g._private.isHovered||(g._private.isHovered=!0,g.mouseOver()))}},ZUI.changeActiveView=function(a){ZUI.activeView.inactive(),ZUI.activeView=a,ZUI.activeView.active()},ZUI.mouseDown=function(a){for(var b=ZUI.mouseStatus.x,c=ZUI.mouseStatus.y,d=ZUI.activeView.renderedObjects,e=null,f=d.length-1;f>=0;f--)if(d[f].isInBound(b,c)){e=d[f];break}0==a.button?(ZUI.mouseStatus.leftDown=!0,ZUI.activeView.leftMouseDown(),e&&e.leftMouseDown()):1==a.button?(ZUI.mouseStatus.middleDown=!0,ZUI.activeView.middleMouseDown(),e&&e.middleMouseDown()):2==a.button&&(ZUI.mouseStatus.rightDown=!0,ZUI.activeView.rightMouseDown(),e&&e.rightMouseDown()),ZUI.passInputEvent&&ZUI.passInputEvent(a)},ZUI.mouseUp=function(a){for(var b=ZUI.mouseStatus.x,c=ZUI.mouseStatus.y,d=ZUI.activeView.renderedObjects,e=null,f=d.length-1;f>=0;f--)if(d[f].isInBound(b,c)){e=d[f];break}0==a.button?(ZUI.mouseStatus.leftDown=!1,ZUI.activeView.leftMouseUp(),e&&e.leftMouseUp()):1==a.button?(ZUI.mouseStatus.middleDown=!1,ZUI.activeView.middleMouseUp(),e&&e.middleMouseUp()):2==a.button&&(ZUI.mouseStatus.rightDown=!1,ZUI.activeView.rightMouseUp(),e&&e.rightMouseUp()),ZUI.passInputEvent&&ZUI.passInputEvent(a)},ZUI.mouseMove=function(a){var b=ZUI.getMousePosition(a);ZUI.mouseStatus.xLast=ZUI.mouseStatus.x,ZUI.mouseStatus.yLast=ZUI.mouseStatus.y,ZUI.mouseStatus.x=b.x,ZUI.mouseStatus.y=b.y;for(var c=ZUI.mouseStatus.x,d=ZUI.mouseStatus.y,e=ZUI.activeView.renderedObjects,f=null,g=0;g<e.length;g++)e[g].isInBound(c,d)&&(f=e[g]);for(ZUI.activeView.mouseMove(),g=0;g<e.length;g++)e[g]!=f&&e[g].isHovered&&(e[g].isHovered=!1,e[g].mouseOut());f&&(f.mouseMove(),f.isHovered||(f.isHovered=!0,f.mouseOver())),ZUI.passInputEvent&&ZUI.passInputEvent(a)},ZUI.click=function(a){for(var b=ZUI.mouseStatus.x,c=ZUI.mouseStatus.y,d=ZUI.activeView.renderedObjects,e=null,f=d.length-1;f>=0;f--)if(d[f].isInBound(b,c)){e=d[f];break}0==a.button?(ZUI.contextMenu.active&&ZUI.contextMenu.close(),ZUI.activeView.leftClick(),e&&e.leftClick()):1==a.button?(ZUI.activeView.middleClick(),e&&e.middleClick()):2==a.button&&(ZUI.activeView.rightClick(),e&&e.rightClick()),ZUI.passInputEvent&&ZUI.passInputEvent(a)},ZUI.doubleClick=function(a){for(var b=ZUI.mouseStatus.x,c=ZUI.mouseStatus.y,d=ZUI.activeView.renderedObjects,e=null,f=d.length-1;f>=0;f--)if(d[f].isInBound(b,c)){e=d[f];break}0==a.button?(ZUI.activeView.leftDoubleClick(),e&&e.leftDoubleClick()):1==a.button&&(ZUI.activeView.middleDoubleClick(),e&&e.middleDoubleClick()),ZUI.passInputEvent&&ZUI.passInputEvent(a)},ZUI.mouseWheel=function(a){a.preventDefault();for(var b=Math.max(-1,Math.min(1,a.wheelDelta||-a.detail)),c=ZUI.mouseStatus.x,d=ZUI.mouseStatus.y,e=ZUI.activeView.renderedObjects,f=null,g=e.length-1;g>=0;g--)if(e[g].isInBound(c,d)){f=e[g];break}ZUI.activeView.mouseWheel(b),f&&f.mouseWheel(b),ZUI.passInputEvent&&ZUI.passInputEvent(a)},ZUI.contextMenu=function(a){for(var b=ZUI.mouseStatus.x,c=ZUI.mouseStatus.y,d=ZUI.activeView.renderedObjects,e=null,f=d.length-1;f>=0;f--)if(d[f].isInBound(b,c)){e=d[f];break}ZUI.activeView.contextMenu(),e&&e.contextMenu(),ZUI.passInputEvent&&ZUI.passInputEvent(a)},ZUI.fireEvent=function(a){var b=ZUI.eventListeners.get(a.type);if(b){var c=b.get(a.target);if(c)for(var d=0;d<c.length;d++)c[d].callback(a,a.data,c[d].data);var e=b.get("_all");if(e)for(d=0;d<e.length;d++)e[d].callback(a,a.data,e[d].data)}},ZUI.addEventListener=function(a){var b=ZUI.eventListeners.get(a.type);b||(b=new ZUI.Hash,ZUI.eventListeners.put(a.type,b));var c=a.target;(void 0===c||null===c)&&(c="_all");var d=b.get(c);d||(d=[],b.put(c,d)),d.push(a)},ZUI.removeEventListener=function(a){var b=ZUI.eventListeners.get(a.type);if(b){var c=a.target;(void 0===c||null===c)&&(c="_all");var d=b.get(c);if(d){var e=d.indexOf(a);0>e||(d.splice(e,1),0==d.length&&b.delete(c),0==b.length&&ZUI.eventListeners.delete(a.type))}}},ZUI.removeEventListenersForTarget=function(a){for(var b=ZUI.eventListeners.getKeys(),c=0;c<b.length;c++){var d=b[c],e=ZUI.eventListeners.get(d);e.get(a)&&e.delete(a),e.getSize()||ZUI.eventListeners.delete(d)}},ZUI.update=function(){}}(),function(){ZUI.View=function(){ZUI.Base.call(this),this.renderedObjects=[],this.animations=[]},ZUI.Helper.inheritClass(ZUI.Base,ZUI.View),ZUI.View.prototype.animate=function(a){this.animations.push(a),a.begin()},ZUI.View.prototype.active=function(){},ZUI.View.prototype.inactive=function(){},ZUI.View.prototype.draw=function(){},ZUI.View.prototype.remove=function(){},ZUI.View.prototype.leftMouseDown=function(){},ZUI.View.prototype.middleMouseDown=function(){},ZUI.View.prototype.rightMouseDown=function(){},ZUI.View.prototype.leftMouseUp=function(){},ZUI.View.prototype.middleMouseUp=function(){},ZUI.View.prototype.rightMouseUp=function(){},ZUI.View.prototype.mouseMove=function(){},ZUI.View.prototype.leftClick=function(){},ZUI.View.prototype.middleClick=function(){},ZUI.View.prototype.rightClick=function(){},ZUI.View.prototype.leftDoubleClick=function(){},ZUI.View.prototype.middleDoubleClick=function(){},ZUI.View.prototype.mouseWheel=function(){},ZUI.View.prototype.contextMenu=function(){}}(),function(){ZUI.Animation=function(a){this.view=void 0===a.view?null:a.view,this.duration=void 0===a.duration?0:a.duration,this.type=void 0===a.type?"custom":a.type,this._begin=void 0===a.begin?function(){}:a.begin,this._end=void 0===a.end?function(){}:a.end,this._draw=void 0===a.draw?function(){}:a.draw,this.data=void 0===a.data?null:a.data,"zoom"==this.type&&(this.bezier=void 0===a.bezier?[.25,.1,.25,1]:a.bezier,this.spline=new ZUI.Util.KeySpline(this.bezier[0],this.bezier[1],this.bezier[2],this.bezier[3]),this.sourceX=void 0===a.sourceX?void 0:a.sourceX,this.sourceY=void 0===a.sourceY?void 0:a.sourceY,this.sourceDistance=void 0===a.sourceDistance?void 0:a.sourceDistance,this.targetX=void 0===a.targetX?void 0:a.targetX,this.targetY=void 0===a.targetY?void 0:a.targetY,this.targetDistance=void 0===a.targetDistance?void 0:a.targetDistance)},ZUI.Animation.prototype.begin=function(){this.view&&(this.view.animation=this),this.startTime=ZUI.Util.getTime(),this.remainingTime=this.duration,"zoom"==this.type&&(void 0===this.sourceX&&(this.sourceX=ZUI.camera._x),void 0===this.sourceY&&(this.sourceY=ZUI.camera._y),void 0===this.sourceDistance&&(this.sourceDistance=ZUI.camera._distance),void 0===this.targetX&&(this.targetX=this.sourceX),void 0===this.targetY&&(this.targetY=this.sourceY),void 0===this.targetDistance&&(this.targetDistance=this.sourceDistance)),this._begin(this.data),this.remainingTime<=0&&this.end()},ZUI.Animation.prototype.end=function(){this.view&&this.view.animation==this&&(this.view.animation=null),"zoom"==this.type&&(ZUI.camera._x=ZUI.camera.x=this.targetX,ZUI.camera._y=ZUI.camera.y=this.targetY,ZUI.camera._distance=ZUI.camera.distance=this.targetDistance),this._end(this.data)},ZUI.Animation.prototype.draw=function(){var a=ZUI.Util.getTime();if(this.elapsedTime=a-this.startTime,this.remainingTime=this.duration-this.elapsedTime,this.remainingTime>0){if("zoom"==this.type){var b=this.elapsedTime/(this.elapsedTime+this.remainingTime),c=this.spline.get(b);ZUI.camera._x=ZUI.camera.x=(this.targetX-this.sourceX)*c+this.sourceX,ZUI.camera._y=ZUI.camera.y=(this.targetY-this.sourceY)*c+this.sourceY,ZUI.camera._distance=ZUI.camera.distance=(this.targetDistance-this.sourceDistance)*c+this.sourceDistance}this._draw(this.elapsedTime,this.remainingTime,this.view,this.data)}else this.end()}}(),function(){ZUI.ContextMenu=function(){ZUI.Base.call(this),this.options=null,this.x=0,this.y=0,this.active=!1,this.container=document.createElement("div"),this.container.className="zui-contextMenu",this.container.style.border="1px solid #B4B4B4",this.container.style.width="160px",this.container.style.height="auto",this.container.style.minHeight="0",this.container.style.position="relative",this.container.style.left=(this.x>ZUI.width/2?this.x-162:this.x)+"px",this.container.style.top=this.y+"px",this.container.oncontextmenu=function(){return!1}},ZUI.Helper.inheritClass(ZUI.Base,ZUI.ContextMenu),ZUI.ContextMenu.prototype.open=function(a,b,c){this.active&&this.close(),void 0===a&&void 0===b?(this.x=ZUI.mouseStatus.x,this.y=ZUI.mouseStatus.y,this.container.style.left=(this.x>ZUI.width/2?this.x-162:this.x)+"px",this.container.style.top=this.y+"px"):(this.x=a,this.y=b,this.container.style.left=(this.x>ZUI.width/2?this.x-162:this.x)+"px",this.container.style.top=this.y+"px"),this.options=c;for(var d=0;d<c.length;d++)this.container.appendChild(c[d].container),c[d].contextMenu=this;ZUI.container.appendChild(this.container),this.active=!0},ZUI.ContextMenu.prototype.close=function(){ZUI.container.removeChild(this.container),this.options=null,this.container.innerHTML="",this.active=!1},ZUI.ContextMenu.Option=function(a,b,c,d,e){ZUI.Base.call(this),this.label=a,this.callback=b,this.data=c,this.enabled=void 0===d?!0:d,this.autoClose=void 0===e?!0:e,this.contextMenu=null,this.container=document.createElement("span"),this.container.className="zui-contextMenu-option",this.container.style.padding="3px 20px",this.container.style.display="block",this.container.style.width="120px",this.enabled?(this.container.style.backgroundColor="#FFFFFF",this.container.style.color="#3C3C3C"):(this.container.style.backgroundColor="#FFFFFF",this.container.style.color="#B4B4B4"),this.container.innerHTML=a,this.container.onmouseover=function(){this.enabled?(this.container.style.backgroundColor="#787878",this.container.style.color="#FFFFFF"):(this.container.style.backgroundColor="#FFFFFF",this.container.style.color="#B4B4B4")}.bind(this),this.container.onmouseout=function(){this.enabled?(this.container.style.backgroundColor="#FFFFFF",this.container.style.color="#3C3C3C"):(this.container.style.backgroundColor="#FFFFFF",this.container.style.color="#B4B4B4")}.bind(this),this.container.onclick=function(){this.callback(this.data),this.autoClose&&this.contextMenu.active&&this.contextMenu.close()}.bind(this)},ZUI.Helper.inheritClass(ZUI.Base,ZUI.ContextMenu.Option)}(),function(){ZUI.Camera={}}(),function(){ZUI.Camera.DefaultCamera=function(a){ZUI.Base.call(this);for(var b in a)this[b]=a[b];var c=this;!function(){var a={data:{},position:{x:0,y:0},truePosition:{x:0,y:0},positionOffset:{x:0,y:0},distance:null,trueDistance:null,fov:Math.PI/2,followRate:1};a.distance=a.trueDistance=ZUI.width/2/Math.tan(a.fov/2);for(var b in a)ZUI.Helper.assignDefaultProperty(b,c,a[b])}()},ZUI.Helper.inheritClass(ZUI.Base,ZUI.Camera.DefaultCamera),ZUI.Camera.DefaultCamera.prototype.update=function(){this.truePosition.x!=this.position.x&&(this.truePosition.x+=(this.position.x-this.truePosition.x)*this.moveRate,Math.abs(this.position.x-this.truePosition.x)<.005*this.trueDistance&&(this.truePosition.x=this.position.x)),this.truePosition.y!=this.position.y&&(this.truePosition.y+=(this.position.y-this.truePosition.y)*this.moveRate,Math.abs(this.position.y-this.truePosition.y)<.005*this.trueDistance&&(this.truePosition.y=this.position.y)),this.trueDistance!=this.distance&&(this.trueDistance+=(this.distance-this.trueDistance)*this.moveRate,Math.abs(this.distance-this.trueDistance)<.005*this.trueDistance&&(this.trueDistance=this.distance))},ZUI.Camera.DefaultCamera.prototype.setPosition=function(a,b){this.position.x=this.truePosition.x=a,this.position.y=this.truePosition.y=b},ZUI.Camera.DefaultCamera.prototype.setDistance=function(a){this.distance=this.trueDistance=a},ZUI.Camera.DefaultCamera.prototype.projectPoint=function(a){var b=ZUI.width/(Math.tan(this.fov/2)*this.trueDistance*2);return{x:(a.x-ZUI.camera._x)*b+ZUI.width/2,y:(a.y-ZUI.camera._y)*b+ZUI.height/2}},ZUI.Camera.DefaultCamera.prototype.unprojectPoint=function(a){var b=ZUI.width/(Math.tan(this.fov/2)*this.trueDistance*2);return{x:(a.x-ZUI.width/2)/b+ZUI.camera.truePosition.x,y:(a.y-ZUI.height/2)/b+ZUI.camera.truePosition.y}},ZUI.Camera.DefaultCamera.prototype.projectDistance=function(a){var b=ZUI.width/(Math.tan(this.fov/2)*this.trueDistance*2);return a*b},ZUI.Camera.DefaultCamera.prototype.unprojectDistance=function(a){var b=ZUI.width/(Math.tan(this.fov/2)*this.trueDistance*2);return a/b},ZUI.Camera.DefaultCamera.prototype.reset=function(){this.setPosition(0,0),this.setDistance(ZUI.width/2/Math.tan(this.fov/2))}}(),function(){ZUI.RenderedObject={}}(),function(){ZUI.RenderedObject.Base=function(a){ZUI.Base.call(this),this._private.isUpdated=!0,this._private.isReady=!1,this._private.canvas=document.createElement("canvas"),this._private.context=this._private.canvas.getContext("2d"),this._private.views=[],this._private.isHovered=!1,this._private.canvas.width=ZUI.width,this._private.canvas.height=ZUI.height;for(var b in a)this[b]=a[b];var c=this;!function(){var a={data:{},position:{x:0,y:0},positionScale:ZUI.Def.WorldScale,positionOffset:{x:0,y:0},positionOffsetScale:ZUI.Def.ScreenScale,rotate:0,hStretch:1,vStretch:1,stroke:!0,strokeColor:"#000000",strokeThickness:1,strokeThicknessScale:ZUI.Def.WorldScale,fill:!0,fillColor:"#FFFFFF",alpha:1,centerAt:{horizontal:ZUI.Def.Left,vertical:ZUI.Def.Top}};for(var b in a)ZUI.Helper.assignDefaultProperty(b,c,a[b])}()},ZUI.Helper.inheritClass(ZUI.Base,ZUI.RenderedObject.Base),ZUI.RenderedObject.Base.prototype.attachToView=function(a){return this._private.views.push(a),a.renderedObjects.push(this),this},ZUI.RenderedObject.Base.prototype.detachFromView=function(a){return ZUI.Helper.removeFromArray(this._private.views,a),ZUI.Helper.removeFromArray(a.renderedObjects,this),this},ZUI.RenderedObject.Base.prototype.draw=function(){this._private.isUpdated&&this.render(),ZUI.context.drawImage(this._private.canvas,0,0)},ZUI.RenderedObject.Base.prototype.pointHitTest=function(a,b){this._private.context.isPointInPath(a,b)},ZUI.RenderedObject.Base.prototype.render=function(){this._private.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.renderedPosition=ZUI.Helper.interpretScale(this.position,this.positionScale),this.renderedPositionOffset=ZUI.Helper.interpretScale(this.positionOffset,this.positionOffsetScale),this.renderedStrokeThickness=ZUI.Helper.interpretScale(this.strokeThickness,this.strokeThicknessScale)}}(),function(){ZUI.RenderedObject.Circle=function(a){ZUI.RenderedObject.Base.call(this,a);var b=this;!function(){var a={radius:0,radiusScale:ZUI.Def.WorldScale};for(var c in a)ZUI.Helper.assignDefaultProperty(c,b,a[c]);var a={hRadius:b.radius,hRadiusScale:b.radiusScale,vRadius:b.radius,vRadiusScale:b.radiusScale};for(var c in a)ZUI.Helper.assignDefaultProperty(c,b,a[c])}(),this._private.isReady=!0},ZUI.Helper.inheritClass(ZUI.RenderedObject.Base,ZUI.RenderedObject.Circle),ZUI.RenderedObject.Circle.prototype.render=function(){ZUI.RenderedObject.Base.prototype.render.call(this),this.renderedRadius=ZUI.Helper.interpretScale(this.radius,this.radiusScale),this.renderedHRadius=ZUI.Helper.interpretScale(this.hRadius,this.hRadiusScale),this.renderedVRadius=ZUI.Helper.interpretScale(this.vRadius,this.vRadiusScale);var a=ZUI.Helper.interpretCenterAt({x:this.renderedPosition.x-this.renderedRadius,y:this.renderedPosition.y-this.renderedRadius},this.renderedPositionOffset,2*this.renderedRadius,2*this.renderedRadius,this.centerAt);this._private.context.save(),this._private.context.strokeStyle=this.strokeColor,this._private.context.fillStyle=this.fillColor,this._private.context.globalAlpha=this.alpha,this._private.context.lineWidth=this.renderedStrokeThickness,this._private.context.save(),this._private.context.translate(a.x,a.y),this._private.context.scale(this.hStretch*this.renderedHRadius,this.vStretch*this.renderedVRadius),this._private.context.rotate(this.rotate),this._private.context.beginPath(),this._private.context.arc(0,0,1,0,2*Math.PI),this._private.context.closePath(),this._private.context.restore(),this.stroke&&this._private.context.stroke(),this.fill&&this._private.context.fill(),this._private.context.restore(),this._private.isUpdated=!1}}(),function(){ZUI.RenderedObject.LinePath=function(a){ZUI.RenderedObject.Base.call(this,a);var b=this;!function(){var a={vertices:[]};for(var c in a)ZUI.Helper.assignDefaultProperty(c,b,a[c]);for(var a={verticesScale:[]},d=0;d<b.vertices.length;d++)a.verticesScale.push("world");for(var c in a)ZUI.Helper.assignDefaultProperty(c,b,a[c])}(),this._private.isReady=!0},ZUI.Helper.inheritClass(ZUI.RenderedObject.Base,ZUI.RenderedObject.LinePath),ZUI.RenderedObject.LinePath.prototype.render=function(){ZUI.RenderedObject.Base.prototype.render.call(this),this.renderedVertices=[];for(var a=0;a<this.vertices.length;a++)this.renderedVertices.push(ZUI.Helper.interpretScale(this.vertices[a],this.verticesScale[a]));this._private.context.save(),this._private.context.strokeStyle=this.strokeColor,this._private.context.fillStyle=this.fillColor,this._private.context.globalAlpha=this.alpha,this._private.context.lineWidth=this.renderedStrokeThickness,this._private.context.save(),this._private.context.translate(this.renderedPosition.x,this.renderedPosition.y),this._private.context.scale(this.hStretch,this.vStretch),this._private.context.rotate(this.rotate),this._private.context.beginPath(),this._private.context.moveTo(this.renderedVertices[0].x,this.renderedVertices[0].y);for(var a=1;a<this.renderedVertices.length;a++)this._private.context.lineTo(this.renderedVertices[a].x,this.renderedVertices[a].y);this._private.context.closePath(),ZUI.context.restore(),this.stroke&&this._private.context.stroke(),this.fill&&this._private.context.fill(),this._private.context.restore(),this._private.isUpdated=!1}}();